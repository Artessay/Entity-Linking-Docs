# 知识推理调研

## 目标

让大模型在回答用户提问时，能够尽可能利用到知识图谱中额外的关系信息辅助完成推理和回答。

## 整体思路

1. 准备相关知识图谱（KG）和大语言模型（LLM）
2. 利用**实体链接**技术，将用户输入文本中的提及链接到知识图谱中的对应实体上
3. 在知识图谱上对所有抽取到的实体进行**单跳查询**或n跳查询，找出与这些实体具有直接关联的三元组及相应实体
4. 把这些三元组等信息作为额外的提示词（prompt）提供给大语言模型，辅助进行更好的决策
5. 在问答数据集上对大语言模型的回答质量进行评估

## 调研内容

* 通用知识图谱
  * Wikidata
    * [x] 数据集获取
      * 以结构化形式存储海量数据的通用知识图谱。数据开源，权威性强，含超过90M的实体，整个数据集压缩包大小约120G，**已获取到资源**。
    * [x] 实体链接
      * ReFinED：一个**端到端**的实体链接工具，目前在Wikidata上实体链接的效果最佳（SOTA）。能够直接在用户输入的文本内容中找出提及对应的实体并返回在Wikidata上对应的id。
        * 本身模型推理速度快，且准确率较高，允许在新的数据集上进一步fine-tune。相关原理介绍：[可扩展的具备密集实体检索的零次学习实体链接](zh-cn/可扩展的具备密集实体检索的零次学习实体链接)
        * 目前**已经完成**该论文实验结果**复现**，能够直接使用
    * [ ] 单跳查询
      * 暂未找到合适的工具，拟采用宽度优先搜索（BFS）先简单处理
    * [x] 测试数据集
      * 非常多在Wikidata上的QA数据集，如SPARQL、RomQA等
* 医学领域知识图谱
  * CMeKG：
    * [x] 数据集获取
      * 中文医学知识图谱，所有数据以三元组的形式给出，主要包含药物说明、疾病症状等相关内容。非开源，实体总数约100K （10万），三元组总数大约1.6M，**已获取到相关资源**
    * [ ] 实体链接
      * [x] 命名实体识别
        * 借助配套提供的CMeKG_tools工具，可以实现输入文本的命名实体识别，但所识别的仅为提及，在知识图谱中未必能找到对应内容。
        * 该工具已经**完成复现**，整体效果尚可
      * [ ] 实体消歧
        * 将命名实体识别模型中最后一层输出层去除，得到对应提及的词嵌入。该步骤已完成
        * 拟将该模型同步用到知识图谱的所有实体上，通过计算提及与知识图谱中每个实体对应嵌入的**向量内积**来进行实体消歧
    * [x] 单跳查询
      * 采用宽度优先搜索的方法实现单跳查询，已完成相关代码实现
      * 由于数据格式较为特殊，拟之后借助Neo4j等图数据库实现更好的图存储与查询
    * [x] 测试数据集
      * 找到CMeQA数据集，包含约5万个问答，能够辅助进行验证。该数据集采用CC-BY-NC协议，仅供学术交流

## 其他工作

* 尝试复现一篇**知识增强语言模型适应性**的论文（"KALA: Knowledge-Augmented Language Model Adaptation" (NAACL 2022)）的工作
  * 该工作基于医学问答的emrQA数据集和新闻问答的newsQA数据集。
  * 我们在新闻问答数据集上的复现基本完成，暂未获得医学问题数据集
* 寻找了其他一些医学方面具有较好实体链接工具的数据集
  * NCBI disease
    * 英文医学疾病相关数据集，在实体链接非常常用的数据集
    * 已获取数据集相关资源
    * 已获取数据集实体链接代码
    * 该数据集中不包含明显的关系，更像是一个知识库，只有各个概念之间的归属，可能难以完成推理工作，遂舍弃
  * BC5CDR
    * 医学实体链接非常常用的数据集
    * 已获取数据集相关资源
    * 已获取到该数据集实体链接相关代码
    * 该数据集中不包含明显的关系，可能难以完成推理工作，遂舍弃
  * WikiMed
    * 该数据集与Wikidata格式十分相似，有望作为Wikidata的附加数据集对refined模型进行finetune
    * 其本身也有其他人已经实现的效果较好的实体链接模型，已获取到相关代码
  * 